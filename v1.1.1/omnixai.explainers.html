<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>omnixai.explainers package &mdash; OmniXAI  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="omnixai.explainers.data package" href="omnixai.explainers.data.html" />
    <link rel="prev" title="omnixai.preprocessing package" href="omnixai.preprocessing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            OmniXAI
          </a>
              <div class="version">
                v1.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="omnixai.html">OmniXAI: An Explanation Toolbox</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#library-design">Library Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#more-examples">More Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#how-to-contribute">How to Contribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#modules-for-different-data-types">Modules for Different Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#preprocessing-functions">Preprocessing Functions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="omnixai.html#supported-explanation-methods">Supported Explanation Methods</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">omnixai.explainers package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-omnixai.explainers.base">omnixai.explainers.base module</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#omnixai.explainers.base.ExplainerABCMeta"><code class="docutils literal notranslate"><span class="pre">ExplainerABCMeta</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#omnixai.explainers.base.ExplainerBase"><code class="docutils literal notranslate"><span class="pre">ExplainerBase</span></code></a><ul>
<li class="toctree-l6"><a class="reference internal" href="#omnixai.explainers.base.ExplainerBase.explain"><code class="docutils literal notranslate"><span class="pre">ExplainerBase.explain()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#omnixai.explainers.base.ExplainerBase.explanation_type"><code class="docutils literal notranslate"><span class="pre">ExplainerBase.explanation_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#omnixai.explainers.base.AutoExplainerBase"><code class="docutils literal notranslate"><span class="pre">AutoExplainerBase</span></code></a><ul>
<li class="toctree-l6"><a class="reference internal" href="#omnixai.explainers.base.AutoExplainerBase.explain"><code class="docutils literal notranslate"><span class="pre">AutoExplainerBase.explain()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#omnixai.explainers.base.AutoExplainerBase.explain_global"><code class="docutils literal notranslate"><span class="pre">AutoExplainerBase.explain_global()</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#omnixai.explainers.base.AutoExplainerBase.explainer_names"><code class="docutils literal notranslate"><span class="pre">AutoExplainerBase.explainer_names</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="#omnixai.explainers.base.AutoExplainerBase.list_explainers"><code class="docutils literal notranslate"><span class="pre">AutoExplainerBase.list_explainers()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#explainers-for-different-tasks">Explainers for different tasks</a><ul>
<li class="toctree-l5"><a class="reference internal" href="omnixai.explainers.data.html">omnixai.explainers.data package</a></li>
<li class="toctree-l5"><a class="reference internal" href="omnixai.explainers.prediction.html">omnixai.explainers.prediction package</a></li>
<li class="toctree-l5"><a class="reference internal" href="omnixai.explainers.tabular.html">omnixai.explainers.tabular package</a></li>
<li class="toctree-l5"><a class="reference internal" href="omnixai.explainers.vision.html">omnixai.explainers.vision package</a></li>
<li class="toctree-l5"><a class="reference internal" href="omnixai.explainers.nlp.html">omnixai.explainers.nlp package</a></li>
<li class="toctree-l5"><a class="reference internal" href="omnixai.explainers.timeseries.html">omnixai.explainers.timeseries package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#modules-for-explanation-results">Modules for Explanation Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.html#dashboard-for-visualization">Dashboard for Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials &amp; Example Code</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OmniXAI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="omnixai.html">OmniXAI: An Explanation Toolbox</a></li>
      <li class="breadcrumb-item active">omnixai.explainers package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/omnixai.explainers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="omnixai-explainers-package">
<h1>omnixai.explainers package<a class="headerlink" href="#omnixai-explainers-package" title="Permalink to this heading"></a></h1>
<p>This package contains all the supported explainers. In practice, we recommend using
use <code class="xref py py-mod docutils literal notranslate"><span class="pre">omnixai.explainers.tabular.TabularExplainer</span></code>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">omnixai.explainers.vision.VisionExplainer</span></code>,
<code class="xref py py-mod docutils literal notranslate"><span class="pre">omnixai.explainers.nlp.NLPExplainer</span></code>, and <code class="xref py py-mod docutils literal notranslate"><span class="pre">omnixai.explainers.timeseries.TimeseriesExplainer</span></code>
for tabular, vision, NLP and time series tasks, respectively, and using <a class="reference internal" href="omnixai.explainers.data.html#omnixai.explainers.data.DataAnalyzer" title="omnixai.explainers.data.DataAnalyzer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">omnixai.explainers.data.DataAnalyzer</span></code></a>
and <a class="reference internal" href="omnixai.explainers.prediction.html#omnixai.explainers.prediction.PredictionAnalyzer" title="omnixai.explainers.prediction.PredictionAnalyzer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">omnixai.explainers.prediction.PredictionAnalyzer</span></code></a> for feature analysis and prediction result analysis.
To generate explanations, one only needs to specify the ML model, the pre-processing function (converting raw data into the model
inputs), the post-processing function (e.g., converting the model outputs into class probabilities, optional),
and the explainer names (e.g., lime, shap, gradcam):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">explainers</span> <span class="o">=</span> <span class="n">TabularExplainer</span><span class="p">(</span>
    <span class="n">explainers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lime&quot;</span><span class="p">,</span> <span class="s2">&quot;shap&quot;</span><span class="p">,</span> <span class="s2">&quot;mace&quot;</span><span class="p">,</span> <span class="s2">&quot;pdp&quot;</span><span class="p">],</span>        <span class="c1"># The explainers to apply</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">,</span>                             <span class="c1"># The task type</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>                                         <span class="c1"># The data for initializing the explainers</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>                                       <span class="c1"># The ML model to explain</span>
    <span class="n">preprocess</span><span class="o">=</span><span class="n">preprocess_function</span><span class="p">,</span>                    <span class="c1"># The preprocessing function</span>
    <span class="n">postprocess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                                  <span class="c1"># The postprocessing function</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;lime&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;kernel_width&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
        <span class="s2">&quot;shap&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;nsamples&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
        <span class="s2">&quot;mace&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;ignored_features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Race&quot;</span><span class="p">,</span> <span class="s2">&quot;Relationship&quot;</span><span class="p">,</span> <span class="s2">&quot;Capital Loss&quot;</span><span class="p">]}</span>
    <span class="p">}</span>                                                  <span class="c1"># Additional parameters</span>
<span class="p">)</span>
<span class="n">local_explanations</span> <span class="o">=</span> <span class="n">explainers</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>             <span class="c1"># Generate local explanations given input `x`</span>
<span class="n">global_explanations</span> <span class="o">=</span> <span class="n">explainers</span><span class="o">.</span><span class="n">explain_global</span><span class="p">()</span>      <span class="c1"># Generate global explanations</span>
</pre></div>
</div>
<p>For vision tasks, e.g., image classification, the explanations can be generated in a similar way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">explainer</span> <span class="o">=</span> <span class="n">VisionExplainer</span><span class="p">(</span>
    <span class="n">explainers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gradcam&quot;</span><span class="p">,</span> <span class="s2">&quot;lime&quot;</span><span class="p">,</span> <span class="s2">&quot;ig&quot;</span><span class="p">],</span>              <span class="c1"># The explainers to apply</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">,</span>                             <span class="c1"># The task type</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>                                       <span class="c1"># The ML model to explain</span>
    <span class="n">preprocess</span><span class="o">=</span><span class="n">preprocess_function</span><span class="p">,</span>                    <span class="c1"># The preprocessing function</span>
    <span class="n">postprocess</span><span class="o">=</span><span class="n">postprocess_function</span><span class="p">,</span>                  <span class="c1"># The postprocessing function</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;gradcam&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;target_layer&quot;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">layer4</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]}}</span>  <span class="c1"># Additional parameters</span>
<span class="p">)</span>
<span class="n">local_explanations</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>            <span class="c1"># Generate local explanations given input `img`</span>
</pre></div>
</div>
<p>For a single explainer, its constructor has one of the following two formats:</p>
<ul class="simple">
<li><p><strong>__init__(self, predict_function, **kwargs)</strong>: This is for model-agnostic explainers. <code class="docutils literal notranslate"><span class="pre">predict_function</span></code>
is the prediction function of the black-box ML model to explain. The inputs of <code class="docutils literal notranslate"><span class="pre">predict_function</span></code> are the raw
input features, and the outputs of <code class="docutils literal notranslate"><span class="pre">predict_function</span></code> are the model outputs.</p></li>
<li><p><strong>__init__(self, model, preprocess_function, postprocess_function, **kwargs)</strong>: This is for model-specific explainers.
<code class="docutils literal notranslate"><span class="pre">model</span></code> is the ML model to explain. The model-specific explainers require
some information about <code class="docutils literal notranslate"><span class="pre">model</span></code>, e.g., whether <code class="docutils literal notranslate"><span class="pre">model</span></code> is differentiable (PyTorch or Tensorflow). <code class="docutils literal notranslate"><span class="pre">preprocess_function</span></code>
is the pre-processing function for <code class="docutils literal notranslate"><span class="pre">model</span></code>, converting the raw features into the inputs of <code class="docutils literal notranslate"><span class="pre">model</span></code>, e.g., resizing
images to (224, 224) and normalizing pixel values. <code class="docutils literal notranslate"><span class="pre">postprocess_function</span></code> is the post-processing function for <code class="docutils literal notranslate"><span class="pre">model</span></code>,
which is used to convert the output logits into class probabilities. <code class="docutils literal notranslate"><span class="pre">postprocess_function</span></code> is mainly used for
visualization, e.g., showing the predicted probabilities in the dashboard. We recommend:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">model</span></code>: It outputs logits for classification or estimated values for regression given the pre-processed inputs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_function</span></code>: It converts the raw input features into the model inputs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">postprocess_function</span></code>: It is ignored in regression tasks or converts logits into class probabilities
in classification tasks.</p></li>
</ul>
</li>
</ul>
<p>For example, a model-agnostic explainer can be applied as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;adult.data&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;Workclass&quot;</span><span class="p">,</span> <span class="s2">&quot;fnlwgt&quot;</span><span class="p">,</span> <span class="s2">&quot;Education&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Education-Num&quot;</span><span class="p">,</span> <span class="s2">&quot;Marital Status&quot;</span><span class="p">,</span> <span class="s2">&quot;Occupation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Relationship&quot;</span><span class="p">,</span> <span class="s2">&quot;Race&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Capital Gain&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Capital Loss&quot;</span><span class="p">,</span> <span class="s2">&quot;Hours per week&quot;</span><span class="p">,</span> <span class="s2">&quot;Country&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span>
<span class="p">]</span>
<span class="n">tabular_data</span> <span class="o">=</span> <span class="n">Tabular</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">feature_columns</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span>
    <span class="n">categorical_columns</span><span class="o">=</span><span class="p">[</span><span class="n">feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">]],</span>
    <span class="n">target_column</span><span class="o">=</span><span class="s1">&#39;label&#39;</span>
<span class="p">)</span>
<span class="c1"># Preprocessing</span>
<span class="n">transformer</span> <span class="o">=</span> <span class="n">TabularTransform</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">tabular_data</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">tabular_data</span><span class="p">)</span>
<span class="c1"># Train an XGBoost model</span>
<span class="n">gbtree</span> <span class="o">=</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">gbtree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>       <span class="c1"># The last column in `x` is the label column</span>

<span class="c1"># Construct the prediction function</span>
<span class="n">predict_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">gbtree</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="c1"># Initialize the SHAP explainer</span>
<span class="n">explainer</span> <span class="o">=</span> <span class="n">ShapTabular</span><span class="p">(</span>
    <span class="n">training_data</span><span class="o">=</span><span class="n">tabular_data</span><span class="p">,</span>
    <span class="n">predict_function</span><span class="o">=</span><span class="n">predict_function</span>
<span class="p">)</span>
</pre></div>
</div>
<p>For a model-specific explainer, e.g., Grad-CAM, one can apply the followings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># A ResNet model to explain</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">resnet50</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Construct the prediction function</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="p">[</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">],</span> <span class="n">std</span><span class="o">=</span><span class="p">[</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">])</span>
<span class="p">])</span>
<span class="n">preprocess</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">images</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">transform</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">to_pil</span><span class="p">())</span> <span class="k">for</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">images</span><span class="p">])</span>
<span class="c1"># Initialize the Grad-CAM explainer</span>
<span class="n">explainer</span> <span class="o">=</span> <span class="n">GradCAM</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">preprocess_function</span><span class="o">=</span><span class="n">preprocess</span><span class="p">,</span>
    <span class="n">target_layer</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">layer4</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>More detailed examples can be found in the tutorials.</p>
<span class="target" id="module-omnixai.explainers"></span><section id="module-omnixai.explainers.base">
<span id="omnixai-explainers-base-module"></span><h2>omnixai.explainers.base module<a class="headerlink" href="#module-omnixai.explainers.base" title="Permalink to this heading"></a></h2>
<p>The base classes for the supported explainers.</p>
<dl class="py class">
<dt class="sig sig-object py" id="omnixai.explainers.base.ExplainerABCMeta">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omnixai.explainers.base.</span></span><span class="sig-name descname"><span class="pre">ExplainerABCMeta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cls_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#omnixai.explainers.base.ExplainerABCMeta" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AutodocABCMeta</span></code></p>
<p>The meta class for an explainer. It will automatically register an explainer class,
i.e., storing it in <code class="docutils literal notranslate"><span class="pre">_EXPLAINERS</span></code>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="omnixai.explainers.base.ExplainerBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omnixai.explainers.base.</span></span><span class="sig-name descname"><span class="pre">ExplainerBase</span></span><a class="headerlink" href="#omnixai.explainers.base.ExplainerBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The abstract base class for an explainer. If an explainer inherits from this class,
it will be registered automatically.</p>
<dl class="py method">
<dt class="sig sig-object py" id="omnixai.explainers.base.ExplainerBase.explain">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">explain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#omnixai.explainers.base.ExplainerBase.explain" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="omnixai.explainers.base.ExplainerBase.explanation_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">explanation_type</span></span><a class="headerlink" href="#omnixai.explainers.base.ExplainerBase.explanation_type" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string indicates the explanation type, e.g., local, global or both</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="omnixai.explainers.base.AutoExplainerBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">omnixai.explainers.base.</span></span><span class="sig-name descname"><span class="pre">AutoExplainerBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">explainers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#omnixai.explainers.base.AutoExplainerBase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The base class for task-specific explainers. The class derived from <cite>AutoExplainerBase</cite>
acts as a explainer factory and provides a unified interface to create explainers, e.g.,
allowing users to choose multiple explainers and generate different explanations at the same time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>explainers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Collection</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – The names or alias of the explainers to use.</p></li>
<li><p><strong>mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The task type, e.g. classification or regression.</p></li>
<li><p><strong>data</strong> (<a class="reference internal" href="omnixai.data.html#omnixai.data.base.Data" title="omnixai.data.base.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a>) – The training data used to initialize explainers.
For image or text explainers, it can be empty, e.g., <cite>data = Image()</cite> or <cite>data = Text()</cite>.</p></li>
<li><p><strong>model</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – The machine learning model to explain, which can be a scikit-learn model,
a tensorflow model, a torch model, or a black-box prediction function.</p></li>
<li><p><strong>preprocess</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>]) – The preprocessing function that converts the raw input features
into the inputs of <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p></li>
<li><p><strong>postprocess</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>]) – The postprocessing function that transforms the outputs of <code class="docutils literal notranslate"><span class="pre">model</span></code>
to a user-specific form, e.g., the predicted probability for each class.</p></li>
<li><p><strong>params</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>]) – A dict containing the additional parameters for initializing each explainer,
e.g., <cite>params[“lime”] = {“param_1”: param_1, …}</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="omnixai.explainers.base.AutoExplainerBase.explain">
<span class="sig-name descname"><span class="pre">explain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#omnixai.explainers.base.AutoExplainerBase.explain" title="Permalink to this definition"></a></dt>
<dd><p>Generates local explanations for the specific instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – The instances to explain.</p></li>
<li><p><strong>params</strong> – A dict containing the additional parameters for generating explanations,
e.g., <cite>params[“lime”] = {“param_1”: param_1, …}</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dict of explanation results generated by the explainers that support local explanation,
e.g. <cite>{“lime”: lime_explanations, “shap”: shap_explanations, …}</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="omnixai.explainers.base.AutoExplainerBase.explain_global">
<span class="sig-name descname"><span class="pre">explain_global</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#omnixai.explainers.base.AutoExplainerBase.explain_global" title="Permalink to this definition"></a></dt>
<dd><p>Generates global explanations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> – A dict containing the additional parameters for generating explanations,
e.g., <cite>params[“pdp”] = {“param_1”: param_1, …}</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dict of explanation results generated by the explainers that support global explanation,
e.g. <cite>{“pdp”: pdp_explanations, …}</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="omnixai.explainers.base.AutoExplainerBase.explainer_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">explainer_names</span></span><a class="headerlink" href="#omnixai.explainers.base.AutoExplainerBase.explainer_names" title="Permalink to this definition"></a></dt>
<dd><p>Gets the names of the specified explainers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Explainer names.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Collection</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="omnixai.explainers.base.AutoExplainerBase.list_explainers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">list_explainers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#omnixai.explainers.base.AutoExplainerBase.list_explainers" title="Permalink to this definition"></a></dt>
<dd><p>List the supported explainers.</p>
</dd></dl>

</dd></dl>

</section>
<section id="explainers-for-different-tasks">
<h2>Explainers for different tasks<a class="headerlink" href="#explainers-for-different-tasks" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="omnixai.explainers.data.html">omnixai.explainers.data package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#omnixai.explainers.data.DataAnalyzer"><code class="docutils literal notranslate"><span class="pre">DataAnalyzer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#omnixai.explainers.data.ImbalanceAnalyzer"><code class="docutils literal notranslate"><span class="pre">ImbalanceAnalyzer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#omnixai.explainers.data.CorrelationAnalyzer"><code class="docutils literal notranslate"><span class="pre">CorrelationAnalyzer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#omnixai.explainers.data.MutualInformation"><code class="docutils literal notranslate"><span class="pre">MutualInformation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#omnixai.explainers.data.ChiSquare"><code class="docutils literal notranslate"><span class="pre">ChiSquare</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#module-omnixai.explainers.data.auto">omnixai.explainers.data.auto module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#module-omnixai.explainers.data.correlation">omnixai.explainers.data.correlation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#module-omnixai.explainers.data.imbalance">omnixai.explainers.data.imbalance module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#module-omnixai.explainers.data.mutual_info">omnixai.explainers.data.mutual_info module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.data.html#module-omnixai.explainers.data.chi_square">omnixai.explainers.data.chi_square module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="omnixai.explainers.prediction.html">omnixai.explainers.prediction package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.prediction.html#omnixai.explainers.prediction.PredictionAnalyzer"><code class="docutils literal notranslate"><span class="pre">PredictionAnalyzer</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="omnixai.explainers.tabular.html">omnixai.explainers.tabular package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.tabular.html#module-omnixai.explainers.tabular.base">omnixai.explainers.tabular.base module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.tabular.html#module-omnixai.explainers.tabular.auto">omnixai.explainers.tabular.auto module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.tabular.html#subpackages">Subpackages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="omnixai.explainers.vision.html">omnixai.explainers.vision package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.vision.html#module-omnixai.explainers.vision.auto">omnixai.explainers.vision.auto module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.vision.html#subpackages">Subpackages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="omnixai.explainers.nlp.html">omnixai.explainers.nlp package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.nlp.html#module-omnixai.explainers.nlp.auto">omnixai.explainers.nlp.auto module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.nlp.html#subpackages">Subpackages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="omnixai.explainers.timeseries.html">omnixai.explainers.timeseries package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.timeseries.html#module-omnixai.explainers.timeseries.auto">omnixai.explainers.timeseries.auto module</a></li>
<li class="toctree-l2"><a class="reference internal" href="omnixai.explainers.timeseries.html#subpackages">Subpackages</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="omnixai.preprocessing.html" class="btn btn-neutral float-left" title="omnixai.preprocessing package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="omnixai.explainers.data.html" class="btn btn-neutral float-right" title="omnixai.explainers.data package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, salesforce.com, inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Versions</span>
      v1.1.1
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        <dt>Versions</dt>
        
          
          <dd><a href="">latest</a></dd>
          
        
          
          <dd><a href="">v1.3.0</a></dd>
          
        
          
          <dd><a href="">v1.2.5</a></dd>
          
        
          
          <dd><a href="">v1.2.4</a></dd>
          
        
          
          <dd><a href="">v1.2.3</a></dd>
          
        
          
          <dd><a href="">v1.2.2</a></dd>
          
        
          
          <dd><a href="">v1.2.1</a></dd>
          
        
          
          <dd><a href="">v1.2.0</a></dd>
          
        
          
          <dd><a href="">v1.1.4</a></dd>
          
        
          
          <dd><a href="">v1.1.3</a></dd>
          
        
          
          <dd><a href="">v1.1.2</a></dd>
          
        
           <strong> 
          <dd><a href="">v1.1.1</a></dd>
           </strong> 
        
          
          <dd><a href="">v1.1.0</a></dd>
          
        
          
          <dd><a href="">v1.0.0</a></dd>
          
        
      </dl>
      
    </div>
  </div>

 <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>